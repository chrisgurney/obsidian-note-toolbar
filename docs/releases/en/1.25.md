What's new in Note Toolbar v1.25?

## New Features üéâ

### Lock Note Toolbar Callouts

This new setting prevents edits to [Note Toolbar Callouts](https://github.com/chrisgurney/obsidian-note-toolbar/wiki/Note-Toolbar-Callouts) when you click/tap on anything other than a toolbar item.
- Enable this setting via **Other ‚Üí Lock Note Toolbar Callouts**. It is disabled by default.
- When enabled, you will need to right-click (long-press on mobile) the callout and select **Edit** to make changes.
- For convenience, the command `Note Toolbar: Lock/Unlock Note Toolbar Callouts` toggles this setting on and off.

## Improvements üöÄ

### Quick Tools

- When clicking items in Quick Tools, hold down `‚åò + shift` (on MacOS) / `ctrl + shift` (on Windows) to open the item for editing, versus executing the item.
  - Note: Duplicates (same label, or tooltip if there's no label, and link or command ID) are not shown in the Quick Tools list. So if you edit an item and change the label (or tooltip if not shown), you will create a new unique entry in the Quick Tools list. 
  - _Thank you @Moyf for the suggestion! [#360](https://github.com/chrisgurney/obsidian-note-toolbar/discussions/360)_

### Settings

- All toolbar previews now show their item's tooltips (when you hover over them with a mouse).
- Script items (i.e., Dataview, JavaScript, JS Engine, Templater) now have a **Focus in editor** option (under **Advanced settings**) that defaults to `true`: After a script is executed, focus is placed in the editor; if set to `false`, it won't be.
- Script items: The **Output callout ID** option has been moved into the **Advanced settings** section.
- Toolbar modal: Pressing the `down` key in the Toolbar's **Name** field now jumps focus down to the item list.
- Item + Style modal: You can now press `ctrl`/`cmd` + `enter` to close these modals. _Thanks @rayzer-hu for the suggestion!_ [#370](https://github.com/chrisgurney/obsidian-note-toolbar/issues/370)
- Item modal: After adding a command for an item via **Add command for item**, a menu option to **Copy command URI** will become available that copies a corresponding [Note Toolbar URI](https://github.com/chrisgurney/obsidian-note-toolbar/wiki/Note-Toolbar-URIs#execute-commands) to run that command to the clipboard.
  - Once you have the URI (e.g., `obsidian://note-toolbar?command=note-toolbar:...`) you can use it from [Note Toolbar Callouts](https://github.com/chrisgurney/obsidian-note-toolbar/wiki/Note-Toolbar-Callouts), for example.
  - _Thanks for the suggestion @rayzer-hu!_ [#370](https://github.com/chrisgurney/obsidian-note-toolbar/issues/370)
- Toolbar modal: A disclaimer is now shown next to the desktop _Floating button_ position and _Item Menu_ fields if Obsidian's **Appearance ‚Üí Native menus** option is _enabled_. This is to let you know that icons will not be shown in menus unless this option is disabled.
- Main settings window: A "no results" message is shown if toolbar search has no results.

### Other Improvements

- The name of the relevant toolbar is now shown at the top of context and item menus, on phones only.
- Toolbar context menu: Moved the lesser-used  _Share..._ + _Copy as callout_ options down the menu.

## Fixes üõ†Ô∏è

- Menus: Items in menus were previously all indented (with a blank placeholder icon) even if none of the items had icons. Now items in a menu will only be indented if at least one item has an icon.
- Quick Tools: Duplicate command items were appearing if `link` text was different; command items are now de-duplicated based on command ID (in addition to its text, i.e., label with a tooltip fallback).
- Some CSS rules applied by certain themes (e.g., Velocity, Primary) are now reset. [#378](https://github.com/chrisgurney/obsidian-note-toolbar/issues/378) _Thanks @middleblazer9i for originally reporting [this issue](https://github.com/Gonzalo-D-Sales/obsidian-velocity/issues/71)._
- In the Edit Item form, the command name was not being updated when the command name changed. _Thank you for identifying this was an issue with QuickAdd @Paining1!_ [#369](https://github.com/chrisgurney/obsidian-note-toolbar/issues/369)
- Toolbars in non-active panes (including hidden panes) were re-rendering, even though it wasn't necessary. _Thanks @Moyf_ [#367](https://github.com/chrisgurney/obsidian-note-toolbar/issues/367)
- Local storage settings that was tracking the properties-folding preference, and recently-used notes and toolbars, is now scoped to the current vault (on the current device). This means that these settings will be reset, but will updated from this point forward.
- When opening the main Note Toolbar settings tab, a console error might have appeared if you had a lot of toolbars: `[Violation] Forced reflow while executing JavaScript took Xms`. This error should no longer show. [#389](https://github.com/chrisgurney/obsidian-note-toolbar/issues/369)
- In settings, several button and style text alignment issues on mobile should now be fixed.
- References to toolbars by name (versus by ID) in `data.json` were previously not resolving. This may occur when importing toolbars from callouts, or if having previously used versions of Note Toolbar before IDs were introduced (in August 2024). _Thanks @laktiv_ [#176](https://github.com/chrisgurney/obsidian-note-toolbar/issues/176)
- Localization resources are now garbage-collected when the plugin is unloaded. _Thanks @kotaindah55 for the fix!_ [#371](https://github.com/chrisgurney/obsidian-note-toolbar/pull/371)
- The reference to the Note Toolbar API is now removed on plugin unload.

## API

### [`ntb.suggester()`](https://github.com/chrisgurney/obsidian-note-toolbar/wiki/Note-Toolbar-API#suggester)

Pressing `tab` now autofills the input with the selected option, for less typing. _Thanks @Moyf for [the idea](https://github.com/chrisgurney/obsidian-note-toolbar/discussions/401#discussioncomment-14771751)!_

Several new options have also been added:

#### `allowCustomInput`

If set to `true`, the user can input a custom value that is not in the list of suggestions. Default is `false`.

```ts
const s = await ntb.suggester(
  ['value 1', 'value 2'], 
  null, 
  { allowCustomInput: true }
);
new Notice(s);
```

#### `default`

When set to some value, this will pre-set the suggester's input with that value. Matching results will be shown, as if you typed in that string yourself (assuming the string appears in the list of options provided).

```ts
// shows "Banana 1" and "Banana 2" as results, by default
const s = await ntb.suggester(
  [ 'Apple', 'Banana 1', 'Banana 2', 'Cantaloupe' ], 
  null,
  { default: 'Banana' }
);
```

#### `label`

Optional text shown above the input field, with markdown formatting supported. Default is no label.

```ts
const s = await ntb.suggester(
  ['value 1', 'value 2'], 
  null, 
  { label: '**Choose something...**' }
);
new Notice(s);
```

_Thank you @moyf for these suggestions in [#384](https://github.com/chrisgurney/obsidian-note-toolbar/discussions/384) and [#401](https://github.com/chrisgurney/obsidian-note-toolbar/discussions/401)_.

### [`ntb.menu()`](https://github.com/chrisgurney/obsidian-note-toolbar/wiki/Note-Toolbar-API#menu)

When the new `focusInMenu` parameter is set to `true`, focus will be set in the menu when it's opened. This is useful for keyboard accessibility. The default is `false`.

Use this with disabling the **Focus in editor** setting to leave focus in the menu that appears (instead of focussing in the editor).

```ts
await ntb.menu([
  { type: 'command', value: 'editor:toggle-bold', label: 'Toggle Bold', icon: 'bold' },
  // ... other menu items go here
], { focusInMenu: true });
```

_Thank you @FelipeRearden for identifying the [accessibility issue](https://github.com/chrisgurney/obsidian-note-toolbar/discussions/233#discussioncomment-13583653)._

## Previous releases

[v1.24](https://github.com/chrisgurney/obsidian-note-toolbar/blob/master/docs/releases/en/1.24.md): Replace the new tab view; support for Bases, Excalidraw, and other file types; hide commands if not available

[v1.23](https://github.com/chrisgurney/obsidian-note-toolbar/blob/master/docs/releases/en/1.23.md): Set focus in editor after executing commands; Hidden props stay hidden; External links can be opened in other views

[v1.22](https://github.com/chrisgurney/obsidian-note-toolbar/blob/master/docs/releases/en/1.22.md): Open in modals; Kanban board support; toolbar rendering improvements

[v1.21](https://github.com/chrisgurney/obsidian-note-toolbar/releases/tag/1.21.1): Note Toolbar Gallery; add items more easily; native JavaScript support 

[v1.20](https://github.com/chrisgurney/obsidian-note-toolbar/releases/tag/1.20.0): Swap toolbars; support for audio/images/PDF/video; add a command for any item