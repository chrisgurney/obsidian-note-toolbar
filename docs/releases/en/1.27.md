> [!IMPORTANT]
> Note Toolbar now requires Obsidian 1.11 or later, in order to support Obsidian's updated mobile experience.

What's new in Note Toolbar v1.27?

_Make sure you've updated to the latest version to get all of these changes._

## New Features üéâ

<img src="https://raw.githubusercontent.com/chrisgurney/obsidian-note-toolbar/master/docs/images/demo_mobile_positions.gif" width="400"/>

### Support for Obsidian 1.11

Obsidian 1.11 comes with an overhauled mobile UI and settings experience. This update of Note Toolbar:
- repositions toolbars to avoid conflicts with the header and navigation bars, on phones; and
- updates the Settings UI to support the new Obsidian 1.11 settings UI elements.

_Give it a try and [let me know what you think](https://github.com/chrisgurney/obsidian-note-toolbar/discussions/447)! (Use this [Google form ‚Üó](https://forms.gle/sa75KNAQiWTtAY4P8) if you don't have a GitHub account.)_

> [!NOTE]
> When using themes with Note Toolbar, particularly on mobile, it may take some time to work out issues. Themes may need to be updated for 1.11, and then Note Toolbar may need to be updated to adjust for those updates. Please report any issues you find.

### Obsidian Navbar item visibility

<img width="600" alt="List of items you can hide from the mobile Navbar" src="https://github.com/user-attachments/assets/94ede83e-eb42-4e64-9990-6305d85b362e" />

Hide items in Obsidian's mobile navigation bar. Select them individually via **Other ‚Üí Navbar item visibility**.

- This provides more room for floating buttons, particularly on smaller phone screens.
- Reduces redundancy if toolbar items replicate (or enhance upon) navigation bar actions.

### Open toolbars with commands as floating toolbars, menus, or in Quick Tools

<img width="600" alt="Toolbar command settings" src="https://github.com/user-attachments/assets/238057e1-c46c-4308-bb18-483f306b813e" />

After enabling **Add toolbar command** in a toolbar's settings, choose where to open that toolbar: as a floating toolbar (default), as a menu, or in a [Quick Tools window](https://github.com/chrisgurney/obsidian-note-toolbar/wiki/Quick-Tools).

- Floating toolbars and menus attempt to show at the cursor position, and fallback to the mouse position.
- Easily see what hotkey was set, and jump to Obsidian's hotkey settings.

_Thank you @FelipeRearden for [the suggestions](https://github.com/chrisgurney/obsidian-note-toolbar/discussions/450)._

## Improvements üöÄ

### Japanese translation

Note Toolbar's UI and [README](https://github.com/chrisgurney/obsidian-note-toolbar/blob/master/README-JA.md) have been translated to Japanese, thanks to @dai!

### Text toolbars

- Text toolbars now appear when selecting text in Reading mode, in markdown embeds, and in Source mode.
- Setting to display toolbars when using the keyboard to select text (under **Toolbars within the app ‚Üí Display for keyboard selections**), which is _enabled_ by default. Disabling this setting _should_ fix [#467](https://github.com/chrisgurney/obsidian-note-toolbar/issues/467). _Thank you @AlbusGuo!_
- Toolbars now reposition as the editor scrolls, instead of vanishing, including in Reading mode. _Thanks for [the suggestion](https://github.com/chrisgurney/obsidian-note-toolbar/discussions/444) @moyf!_
- Pressing `Escape` now dismisses the toolbar.

### Display Editor menu as a toolbar

If a toolbar is selected for the **Toolbars within the app ‚Üí Editor menu** setting, you can now choose to either display the toolbar as a menu (default), or as a toolbar. If enabled, the toolbar uses the styles configured for that toolbar.

### Other improvements

- The `button items` style (renamed to `buttons`) no longer has a background color in `Below properties` and `Bottom` positions.
- Gallery: Added: `Toggle keyboard`, `Set heading 1-6`, `Search for selection`, `File switcher`, `Tab switcher`
- Gallery: `Jump to top` and `Jump to bottom` now also work in Reading/Preview mode. To get the improved versions, re-add these items to your toolbars from the Gallery. _Thanks @DZL1943 for [the improvement](https://github.com/chrisgurney/obsidian-note-toolbar/discussions/412#discussioncomment-15345915)!_
- Gallery: Efficiency improvements to `Next file` and `Previous file`. To get the improved versions, re-add these items to your toolbars from the Gallery. _Thanks @DZL1943 for [the improvement](https://github.com/chrisgurney/obsidian-note-toolbar/discussions/463)!_
- Gallery: Headings are now sorted alphabetically in all supported languages, so it's easier to find what you're after. 
- Item settings: Increased the default size of text areas, to help with scripting.
- Tablets: Item menu titles (that showed the toolbar's name) are no longer added. Now they only appear on phones.
- Importing callouts: Invalid command IDs are now shown in the command field as placeholders (until they're addressed), so users have a better hint as to what plugins might be expected/missing.

### For developers

- Copy a toolbar's developer ID in Note Toolbar's main settings, using **More options (...) ‚Üí Copy developer ID**, located next to each toolbar. Use this as another method to uniquely style toolbars, or use them via the API without worrying if its name might change.
- IDs are now added to menus (displayed via Menu Items) and their options, so they can be individually styled in CSS. Note that Obsidian's _Appearance ‚Üí Native menus_ option must be _disabled_, in order to style menus.

## Fixes üõ†Ô∏è

- The `glass` style is now only available on mobile, due to a "ghosting" display bug it causes on desktops. _I'd like to add it back if it can be fixed._
- The gap between the properties section and note body was previously removed, even if there was no toolbar displayed. [#442](https://github.com/chrisgurney/obsidian-note-toolbar/issues/442) _Thank you @cameronsjo_
- New tab view: Launchpad was not rendered correctly if toolbar is in non-props or non-floating-button positions.
- `Focus` command: Stopped working in `v1.26` for toolbars other than text toolbars. It should now be working again. [#448](https://github.com/chrisgurney/obsidian-note-toolbar/issues/448) _Thank you @FelipeRearden!_
- Importing callouts: Fixed `TypeError: Cannot read properties of undefined (reading getCommandNameById)`. #465 _Thanks @Yu1e_
- What's New notes: When using a non-English language, an error was being displayed (because it was not properly failing over to English).
- Internally, the text toolbar extension is now only registered if it's configured. This is a potential fix for [#451](https://github.com/chrisgurney/obsidian-note-toolbar/issues/451).
- Settings: Removed an invalid use of `this` when displaying script errors. _Thanks @Yu1e, as this was caught when debugging the above issue._
- Rendering performance issue: The toolbar renderer no longer tries to replace `{{selection}}` if that variable is not in the provided label/tooltip/URI to begin with.

## API

### `ntb.toolbar()`

This new API lets you show a (floating) toolbar. Toolbars by default appear next to the toolbar item that triggered the script. However, since you can [execute toolbar items from commands](https://github.com/chrisgurney/obsidian-note-toolbar/wiki/Creating-toolbar-items#more-actions), it might be useful to open toolbars in other locations, such as `cursor` (falling back to the mouse/pointer position), and `pointer`:

```js
// show the "Daily Notes" toolbar at the toolbar button (default)
await ntb.toolbar('Daily Notes');

// show the "Daily Notes" toolbar at the cursor position (falling back to the mouse position)
await ntb.toolbar('Daily Notes', { position: 'cursor' });
```

### `ntb.menu()` Improvements

Instead of individually creating items for your menus, you can provide the name or ID of an existing toolbar:

```js
await ntb.menu('Daily Notes');
```

The position options (`cursor`, `pointer`, `toolbar`) noted above work the same way for `ntb.menu()` as well; default is `toolbar`:

```js
// opens the menu next to the editor cursor (falling back to the mouse position)
await ntb.menu('Daily Notes', { position: 'cursor' });
```

_Thank you @FelipeRearden for [the suggestion](https://github.com/chrisgurney/obsidian-note-toolbar/discussions/450)._

Add your own IDs to menus and menu items, so they can be individually styled in CSS. Note that Obsidian's _Appearance ‚Üí Native menus_ option must be _disabled_, in order to style menus.

```js
await ntb.menu([
  { type: 'file', ..., id: 'item-1234' }
], { id: 'tb-1234' } );
```

Here's where it will appear in the DOM:

```html
<div class="menu note-toolbar-menu" id="tb-1234">
  ...
  <div class="menu-scroll">
    <div class="menu-group">
      <div class="menu-item ..." id="item-1234"> ... </div>
```

_Thank you @codyhahn for [the idea](https://github.com/chrisgurney/obsidian-note-toolbar/discussions/461)._

[See the documentation.](https://github.com/chrisgurney/obsidian-note-toolbar/wiki/Note-Toolbar-API#menu)

### `ntb.getSelection()` Improvements

This function now also returns any selected text in Reading mode, and in embedded markdown.

## Previous releases

[`v1.26`](https://github.com/chrisgurney/obsidian-note-toolbar/blob/master/docs/releases/en/1.26.md) Selected text toolbars; Tab bar position; toggle native Base toolbars; and more

[`v1.25`](https://github.com/chrisgurney/obsidian-note-toolbar/blob/master/docs/releases/en/1.25.md) Lock Note Toolbar Callouts; various quality of life improvements and fixes

[`v1.24`](https://github.com/chrisgurney/obsidian-note-toolbar/blob/master/docs/releases/en/1.24.md) Replace the new tab view; support for Bases, Excalidraw, and other file types; hide commands if not available